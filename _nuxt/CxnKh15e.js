import{d as F,w as H,q as v,ae as N,af as S,c as n,o as s,ag as $,h as p,r as j,k as i,F as b,g as C,A as z,B as T,a as E,t as Y,e as A}from"./BZioxkpp.js";import{T as L}from"./C-iJTia-.js";const O={key:0,class:"absolute top-0 left-0 w-full h-full"},W=["d"],I=["href"],V={key:0,class:"absolute -right-0 text-green-600 fa-solid fa-hand"},q={key:1,class:"absolute -right-0 text-green-900 fa-solid fa-road-spikes"},G={key:0,class:"absolute -left-1 -top-1 text-red-600"},U=F({__name:"MiniMap",props:{disableHover:{type:Boolean,default:!1},disableClick:{type:Boolean,default:!1},highlightPlaces:{default:()=>[]},colorPlaces:{default:()=>({})},specialTags:{default:()=>[]},showAll:{type:Boolean,default:!1},paddingX:{default:.5},paddingY:{default:.5}},async setup(o){let k,P;const X={Carcass_BearCarcass:"Bear",Carcass_BadgerCarcass:"Badger",Carcass_FoxCarcass:"Fox",Carcass_StagCarcass:"Doe",Carcass_DoeCarcass:"Doe",Carcass_BoarCarcass:"Boar",BoarFreeMale:"Boar",MouseRaw:"Mouse",Carcass_PartridgeCarcass:"Partridge",PartridgeTiedFemale:"Partridge",PartridgeTiedMale:"Partridge",SquirrelRaw:"Rodent",Carcass_WolfCarcass:"Wolf"},{mapData:h}=([k,P]=H(()=>A(()=>import("./BKX0hM-3.js"),[],import.meta.url)),k=await k,P(),k).default,c=h.places.filter(a=>{if(a.position.x>1e3)return!1;if(o.showAll||o.highlightPlaces.some(r=>h.places.find(t=>{var e;return(t.card.key==r||((e=t.environment)==null?void 0:e.key)==r||m(t))&&t.backgroundType!="cave"==(a.backgroundType!="cave")})))return!0}),B=h.travelPaths.map(a=>{let r=h.places.find(e=>e.card.key==a.from.key),t=h.places.find(e=>e.card.key==a.to.key);return!c.some(e=>e.card.key==r.card.key)&&!c.some(e=>e.card.key==t.card.key)||!a.toway?null:{from:r.position,to:t.position}}).filter(a=>!!a);function D(){const a=Math.min(...c.map(d=>d.position.x)),r=Math.min(...c.map(d=>d.position.y)),t=Math.max(...c.map(d=>d.position.x)),e=Math.max(...c.map(d=>d.position.y)),f=t-a+1,y=e-r+1;return{minX:a-.1-o.paddingX/2,minY:r-o.paddingY,w:f+o.paddingX,h:y+o.paddingY}}function m(a){var r;return o.highlightPlaces.includes(a.card.key)||o.highlightPlaces.includes((r=a.environment)==null?void 0:r.key)?1:o.highlightPlaces.some(t=>{var e;return((e=a.animals)==null?void 0:e[X[t]??t])==1})?3:o.highlightPlaces.some(t=>a.dropFilter.some(e=>e.card.key==t))?2:0}const l=D(),x=v(null),u=v(0),g=v(0),M=v(0);function w(){if(x.value){const{offsetWidth:a}=x.value,r=3,t=a/l.w,e=t/r;u.value=t,g.value=e,M.value=e*l.h+o.paddingY*g.value}}function R(a){const r=Object.entries(o.colorPlaces).find(([t,e])=>{var f;return e.includes(a.card.key)||e.includes((f=a.environment)==null?void 0:f.key)});return r?{backgroundColor:r[0]}:{}}return N(()=>{w(),window.addEventListener("resize",w)}),S(()=>{window.removeEventListener("resize",w)}),(a,r)=>{const t=L;return s(),n("div",{ref_key:"containerRef",ref:x,class:"relative w-full text-black",style:$([{"background-image":"url('/PaperBGNoBorder.jpg')","background-size":"auto","background-repeat":"no-repeat","image-rendering":"pixelated","border-image-source":"url('/PaperBGNoBorder.jpg')","border-image-slice":"30 fill","border-image-width":"30"},{height:`${M.value}px`,backgroundColor:"#f4e4c1"}])},[i(B).length>0?(s(),n("svg",O,[(s(!0),n(b,null,C(i(B),(e,f)=>(s(),n("path",{key:f,d:`M ${(e.from.x-i(l).minX+.4)*u.value} ${(e.from.y-i(l).minY+.4)*g.value} L ${(e.to.x-i(l).minX+.4)*u.value} ${(e.to.y-i(l).minY+.4)*g.value}`,stroke:"#999966","stroke-width":"1.5",fill:"none"},null,8,W))),128))])):p("",!0),(s(!0),n(b,null,C(i(c),(e,f)=>z((s(),n("div",{style:$({position:"absolute",top:`${(e.position.y-i(l).minY)*g.value}px`,left:`${(e.position.x-i(l).minX)*u.value}px`,width:`${u.value*.8}px`,height:`${g.value*.75}px`,transition:"background-color 0.3s, border-color 0.3s",filter:"drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.2))",...R(e)}),class:T(["relative hover:bg-green-400 hover:cursor-pointer rounded-xl border-1 border-current/20 text-center justify-items-center",{"hover:bg-yellow-100":!a.disableHover,"border-gray-900 border-2 bg-yellow-300":m(e),"border-gray-700/80 text-current/50 bg-[#cdcea4]":!m(e),"cursor-pointer":!a.disableClick}])},[a.disableClick?p("",!0):(s(),n("a",{key:0,href:`/${e.card.key}`,class:"block flex items-center justify-center w-full h-full text-xs overflow-hidden text-nowrap",style:{backgroundImage:"url(/assets/hand-drawn-circle.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat"}},[E("span",{class:T(["w-full text-wrap",{"text-[0.5rem] leading-1.5 ":u.value<70,"text-xs leading-3":u.value>=70}])},Y(e.card[a.$i18n.locale]),3),m(e)==2?(s(),n("i",V)):p("",!0),m(e)==3?(s(),n("i",q)):p("",!0),(s(!0),n(b,null,C(a.specialTags,(y,d)=>{var _;return s(),n(b,null,[e.card.key==y[0]||((_=e.environment)==null?void 0:_.key)==y[0]?(s(),n("div",G,Y(y[1]),1)):p("",!0)],64)}),256))],8,I))],6)),[[t,{value:a.disableHover?"":e.card[a.$i18n.locale],fitContent:!0,pt:{arrow:{style:{}},text:"!bg-primary !text-primary-contrast !font-medium text-xs"}},void 0,{top:!0}]])),256)),j(a.$slots,"default")],4)}}}),Q=Object.assign(U,{__name:"MiniMap"});export{Q as _};
